<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antifürst – Blog</title>
    <link rel="stylesheet" href="../css/format.css">
    <style>
        .post-menu {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .post-menu a,
        .post-menu button {
            background: #222;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            text-decoration: none;
            cursor: pointer;
            transition: background 0.2s;
        }

        .post-menu a:hover,
        .post-menu button:hover {
            background: #444;
        }
    </style>
</head>

<body>
    <header style="background-color:#111111; color:#fff; text-align:center; padding:1em;">
        <h1>Antifürst-Blog</h1>
    </header>

    <main class="container" id="feed">
        <p>Beiträge werden geladen...</p>
    </main>

    <footer style="background-color:#111111; color:#fff; text-align:center; padding:1em;">
        <p>© 2025 Ole Hinrich Bassen</p>
    </footer>

    <script>
        // === Alle Posts nacheinander in die Startseite einbetten ===
        const feed = document.getElementById('feed');
        const postsFolder = 'posts/';
        const latestPostNumber = 10; // <-- höchste Postnummer
        feed.innerHTML = '';

        // Hilfsfunktion für saubere Reihenfolge
        async function loadPostsSequentially() {
            for (let i = latestPostNumber; i >= 1; i--) {
                const postUrl = postsFolder + i + '.html';
                try {
                    const res = await fetch(postUrl);
                    if (!res.ok) {
                        console.warn(`Beitrag ${i} nicht gefunden (${res.status})`);
                        continue;
                    }
                    const html = await res.text();

                    const wrapper = document.createElement('article');
                    wrapper.className = 'article';

                    // Menüleiste über jedem Beitrag
                    const menu = document.createElement('div');
                    menu.className = 'post-menu';

                    // 🌐 Übersetzen mit Google Translate
                    const translateLink = document.createElement('a');
                    translateLink.textContent = 'Translate';
                    translateLink.href = `https://translate.google.com/translate?sl=de&tl=en&u=${encodeURIComponent(window.location.origin + window.location.pathname.replace(/\/[^/]*$/, '/') + postUrl)}`;
                    translateLink.target = '_blank';
                    translateLink.rel = 'noopener noreferrer';

                    // 🔍 Beitrag anzeigen
                    const viewLink = document.createElement('a');
                    viewLink.textContent = 'Show';
                    viewLink.href = postUrl;
                    viewLink.target = '_blank';

                    // 🔗 Teilen
                    const shareBtn = document.createElement('button');
                    shareBtn.textContent = 'Share';
                    shareBtn.addEventListener('click', () => {
                        const shareUrl = window.location.origin + window.location.pathname.replace(/\/[^/]*$/, '/') + postUrl;
                        if (navigator.share) {
                            navigator.share({
                                title: 'Antifürst – Blogbeitrag',
                                url: shareUrl
                            }).catch(err => console.warn('Share abgebrochen:', err));
                        } else {
                            navigator.clipboard.writeText(shareUrl)
                                .then(() => alert('Link kopiert: ' + shareUrl))
                                .catch(() => alert('Link: ' + shareUrl));
                        }
                    });

                    menu.appendChild(translateLink);
                    menu.appendChild(viewLink);
                    menu.appendChild(shareBtn);

                    // Beitrag selbst
                    const content = document.createElement('div');
                    content.innerHTML = html;

                    wrapper.appendChild(menu);
                    wrapper.appendChild(content);
                    feed.appendChild(wrapper);

                } catch (err) {
                    console.warn('Fehler beim Laden von Post ' + i + ':', err);
                }
            }
        }

        // Posts sequentiell laden
        loadPostsSequentially();
    </script>

</body>

</html>